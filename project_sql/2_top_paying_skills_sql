
with top_paying_jobs as (
      select job_id,
            job_title,
            salary_year_avg,
            company_dim.company_id,
            name as company_name
      from job_postings_fact
      left JOIN company_dim on job_postings_fact.company_id = company_dim.company_id
      WHERE
            job_title_short = 'Data Analyst' AND
            job_location = 'Anywhere' AND
            salary_year_avg is NOT NULL
      order by salary_year_avg desc
      limit 10
      )
      SELECT 
            top_paying_jobs.*,
            skills
      from top_paying_jobs
      INNER JOIN skills_job_dim ON top_paying_jobs.job_id = skills_job_dim.job_id
      inner join skills_dim on skills_job_dim.skill_id = skills_dim.skill_id;

/* Top 10 Highest Paying Job Titles 
--Senior and director-level roles dominate, showing leadership and experience bring much higher pay.
Top Companies Offering Highest Salaries 
--A few major tech and telecom companies (like AT&T and others) stand out as leading employers for high-paying data roles.
Most In-Demand Skills 
--SQL, Python, and Excel appear most frequently â€” still the core trio for data analysts.
--Tools like Power BI, Tableau, and R also show strong demand.
Highest Paying Skills 
--Skills tied to cloud computing (Azure, Databricks) and programming (Python, R) command the top salaries.
--Specialized tools such as Snowflake or BigQuery may also push pay higher depending on the company.
*/